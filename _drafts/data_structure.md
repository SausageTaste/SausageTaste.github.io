---
layout: post
title:  "컴퓨터에서 데이터의 표현"
comments: true
use_math: true
---


컴퓨터는 모든 데이터를 0과 1만으로 표현합니다.
이 0과 1만으로 다양한 도시, 인물, 마법효과 등등을 만들어낼 수 있습니다.
0과 1만으로 가상의 세상을 만들 수 있다니, 둘 사이의 간극이 너무 넓죠?
도대체 무슨 원리로 이것이 가능한 건지 감을 잡기 힘듭니다.
지금부터 천천히, 둘 사이의 간극을 메워 보도록 합시다!


# 3차원 모델

## 3차원 모델은 삼각형의 집합

우선 3차원 모델이 컴퓨터에서 어떻게 표현되는지 알아보도록 하겠습니다.
게임을 좋아하시는 분이라면 폴리곤이라는 말을 들어보셨을 텐데요.
폴이곤은 다각형이라는 뜻입니다.
삼각형, 사각형, 오각형 이 모두가 다각형에 속하지요?
이러한 다각형을 그러모아 잘 이어 붙여주면 3차원 물체를 만들 수 있습니다.

<!-- 대충 다양한 물체의 와이어프레임 -->
![image](/assets/images/graphics_01/wireframe_three.png)

현실의 물체는 대단히 복잡합니다.
작은 구슬 하나만 해도 수많은 분자, 원자로 이루어져 있습니다.
컴퓨터의 제한된 성능으로 이 세상을 포현하려면 최대한 단순화해야 합니다.
그래서 복잡한 물체를 폴리곤의 집합으로 단순화한 것이죠.
원자 $10^{28}$개를 처리하는 건 불가능하지만 폴리곤 수만 개 정도면 요즘 컴퓨터한텐 껌이죠!

위 그림을 보시면, 삼각형이 좀 보이고 대부분 사각형으로 이루어져 있습니다.
3차원 물체를 사각형으로 표현하면 물리 연산이나 폴리곤 잘게 쪼개기 같은 연산을 올바르게 수행할 수 있다는 장점이 있기 때문인데요.

그러나 렌더링을 할 때는 대부분 삼각형을 사용합니다.
사각형이나 오각형 이상의 도형은 가위질을 해서 삼각형으로 만들어버기까지 합니다.
사각형을 그대로 사용할 때보다 삼각형을 사용할 때 렌더링 속도에 이점이 있기 때문입니다.
이 내용은 이후 포스트에서 다룰 예정입니다.

저희가 관심있는 것은 게임에서 사용하는 3차원 물체지요?
게임에서는 폴리곤에 직접 물리 연산을 하거나 쪼개기를 하지 않습니다.
블레더나 마야에서 사각형 폴리곤으로 모델링을 한 뒤, 게임에서 사용할 때는 사각형을 모두 삼각형으로 만들어서 출력하지요.
이를 `triangulate`라고 부릅니다.

이후 모든 포스트에서 3차원 물체는 삼각형으로만 이루어져 있다고 가정하겠습니다.

## 삼각형 하나 = 9개의 숫자

컴퓨터는 0과 1만으로 모든 것을 처리한다는 사실을 떠올려 봅시다.
삼각형을 0과 1만으로 표현하려면 우선 숫자로 표현할 수 있어야겠죠?
사실 이는 그리 어렵지 않습니다.

우선 좀 더 단순한 2차원 삼각형에 대해 생각해 봅시다.
2차원 좌표평면에서 한 점을 표현할 때 두 개의 숫자를 한 묶음으로 사용하죠?
그 점이 세 개 있으면 삼각형 하나를 표현할 수 있습니다.
아래 그림의 경우 `(1, 4), (3, 1), (5, 3)` 이렇게 3개의 점, 6개의 숫자로 이루어졌네요.

<!--(대충 2차원 좌표평면에서 삼각형 그림)-->
![image](/assets/images/graphics_01/triangle_on_2d_coord.png)

3차원 좌표공간에서도 방식은 비슷합니다.
점 하나당 숫자를 3개씩 쓰기만 하면 됩니다.

`(대충 3차원 좌표공간에서 삼각형 그림)`

위의 삼각형을 일렬로 나열해 보면 `(1, 2, 3), (4, 5, 6), (7, 8, 9)`처럼 적을 수 있습니다.
3차원 물체는 여러 개의 삼각형으로 이루어져 있다고 했죠?
그러니 3차원 물체를 숫자로 표현한다면 `(1, 2, 3), (4, 5, 6), (7, 8, 9), (1, 2, 3), (4, 5, 6), (7, 8, 9), ...`처럼 숫자를 죽 나열하기만 하면 됩니다!

아니, 이게 실화냐고요?

`(대충 아무 모델 collada로 추출한 모습)`

실제로 업계에서 사용되는 3차원 모델 파일을 열어보면 보시다시피 숫자가 잔뜩 나열된 것을 볼 수 있습니다!

이 숫자들을 0과 1만으로 표현하는 것은 어렵지 않죠.
위에서 보여줬던 삼각형 `(1, 2, 3), (4, 5, 6), (7, 8, 9)`을 0과 1로 표현하면 `010101011101010100010101010...`처럼 됩니다.
이 데이터가 실제로 그래픽카드에 전달되어 화면에 그려지는 것입니다.


# 2차원 이미지

우리가 모니터로 보는 것은 2차원 이미지입니다.
모니터는 평면 맞잖아요?
그러니 3차원 모델은 어떤 방식으로든 2차원 이미지로 변환되어야만 하죠.
그래야 모니터가 보여줄 수 있으니까요.
이 변환이 어떻게 일어나는지 알아보기에 앞서, 우선 2차원 이미지가 컴퓨터에서는 어떻게 생겨먹었는가 알아보자구요!

`(대충 방충망 그림)`

3차원 모델이 여러 개의 삼각형으로 이루어져 있듯, 2차원 이미지를 이루는 작은 무언가가 있겠죠?
컴퓨터에서 모든 이미지는 작은 사각형 여러 개가 방충망처럼 모여있는 형태입니다.
이때 하나의 사각형을 하나의 `픽셀`이라고 부르죠.

이미지는 왼쪽 위의 모서리를 원점으로 삼은 좌표평면과 같습니다.
가령 A가 적힌 픽셀의 위치는 `(a, b)`로 표현할 수 있습니다.

`(대충 방충망과 1차원 방충망 그림)`

픽셀은 화면에 그릴 때는 2차원으로 표현되지만, 컴퓨터에 저장될 때는 결국 1차원으로 표현되어야 합니다.
보통은 왼쪽 위의 픽셀부터 차곡차곡 쌓아가는 형태로 1차원 메모리에 넣습니다.

## 한 픽셀은 하나의 RGB

픽셀 하나는 오직 색깔 하나의 정보만 갖습니다.
그리고 컴퓨터에는 색깔을 표현할 때 RGB 방식을 사용합니다.

`(대충 RGB 그림)`

RGB는 빛의 3원색 빨강(Red), 초록(Green), 파랑(Blue)의 앞글자를 따서 지은 이름인 거 다들 아시죠?
PNG나 JPEG 등 대부분의 이미지 파일, 포토샵, 그림판 등 2차원 이미지를 다룰 땐 대부분 RGB 방식을 사용합니다.

Red, Green, Blue 각각을 채널(channel)이라고 부르는데요.
하나의 채널은 하나의 숫자로 표현됩니다.
RGB 방식엔 세 개의 채널이 있으므로 세 개의 숫자로 표현하면 되는 부분이죠.
예를 몇 가지 들어 볼까요?

빨강 = (1, 0, 0)  
초록 = (0, 1, 0)  
파랑 = (0, 0, 1)  
하양 = (1, 1, 1)  
검정 = (0, 0, 0)  
보라 = (1, 0, 1)  
주황 = (1, 1, 0)  

RGB 각 채널의 값이 어떤 색깔을 만드는가를 이해하려면 글로 설명하기보단 포토샵을 켜보는 게 더 도움이 될 거라 생각합니다.
우리가 중요하게 생각해야 할 것은 따로 있는데요.

우선 각 채널의 값은 무조건 0과 1 사이의 값이어야 한다는 점입니다. 즉 0.2, 0.75, 0.3333은 될 수 있지만 2나 -0.2는 안 됩니다.
그 이유는 손전등을 생각해 보세요.
손전등을 끈 상태를 0으로, 최대 밝기로 켠 상태를 1로 정의합니다.
그리고 반틈만 밝게 켠 경우를 0.5로, 조금 더 밝으면 0.7로 표현할 수 있는데요.
손전등의 최대 밝기 이상인 2만큼 켤 수 없죠.
마찬가지로 손전등 밝기가 마이너스란 것도 말이 안 되죠.
모니터의 각 픽셀도 손전등처럼 최대 밝기가 정해져 있으므로 같은 규칙이 적용됩니다.

`(대충 색깔 있는 방충망 그림)`

각 픽셀이 세 개의 숫자로 이루어져 있다는 사실을 알았습니다.
그러므로 이제 2차원 이미지를 숫자만으로 포현할 수 있게 되었습니다.
왼쪽 위의 픽셀부터 순서대로 적어나가면 되지요.


# 3차원 물체를 2차원 이미지로?

우리는 지금 두 개의 서로 다른 세계를 이어줘야 하는 미션을 수행하고 있습니다.
여러 삼각형으로 이루어진 3차원 물체, 그것을 여러 픽셀로 이루어진 2차원 이미지로 변환해야 합니다.

우선 단순한 상황을 먼저 생각해 봅시다.
흰색 이미지 위에 단 하나의 삼각형을 검은색으로 그리는 문제를 상정해 보겠습니다.
이를 다음 그림과 같이 표현할 수 있겠죠.

`(대충 흰색 방충망 위에 반듯한 삼각형 그림)`

이 상황에서는 문제를 쉽게 해결할 수 있을 것 같습니다!
이미지의 각 픽셀이 삼각형 안에 있으면 검은색으로 칠하고, 밖에 있으면 그냥 넘어가는 식으로 작업을 하면 되죠.
하지만 이것은 삼각형이 때마침 이미지 중간에 그려질 수 있는 좌표값을 갖고 있었던 덕분이죠.
만약 3D 모델링 툴을 이용해 만들어낸 삼각형들을 그대로 그리면 어떤 모습이 될까요?

`(대충 삼각형들이 왼쪽 위에 몰린 모습)`

삼각형들의 좌표값들을 보면 숫자가 제일 커도 2를 넘지 않죠.
그래서 원점인 좌측 상단에 몰려 있는 모양새입니다.
좌표값이 음수인 경우 이미지 범위 바깥이 되므로 잘려버리고요.
3차원 좌표를 2차원으로 바꾸기 위해 z 좌표를 버릴 수밖에 없었습니다.

상황이 이런데 모델을 회전을 어떻게 시킬까요.
직관적으로는 걍 옆으로 빙 돌리면 되지 않느냐 하는 생각이 들겠습니다만.
컴퓨터 입장에서는 회전이 적용된 좌표값을 숫자로 넣어줘야 합니다.
도대체 어떻게 하냐고요.
그것은 다음 글에서 등장할 `행렬`의 전문 분야입니다.
